---
title: "Nuisance Regression"
author: "Liyuan Hu"
date: "2021/5/31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
```

## Nuisance Regression

Nuisance regression refers to best subset selection with some prior information that some varibales are required to stay in the active set. For example, if we are interested in a certain gene and want to find out what other genes are associated with the response when this particular gene shows effect.

## Carrying Out the Nuisance Regression with abess

In the `abess()` function, the argument `always.include` is designed to realize this goal. You can pass a vector containing the indexes of the target variables to `always.include`. Here is an example.

```{r}
library(abess)
n <- 100
p <- 20
support.size <- 3
dataset <- generate.data(n, p, support.size)
dataset$beta

abess_fit <- abess(dataset[["x"]], dataset[["y"]], always.include = 6)
coef(abess_fit, support.size = abess_fit$support.size[which.min(abess_fit$tune.value)])
```