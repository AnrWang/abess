Contribute documentation
============

General procedure
~~~~~~~~~~~~~~~~~

If you’re a more experienced with the abess and are looking forward to
improve your open source development skills, the next step up is to
contribute a pull request to a abess documentation.

In most of case, the workflow is given below, but if you are not familar
with git and github, we suggest you install the `github
desktop <https://desktop.github.com/>`__ that provide a user-friendly
interaction interface for simplifying documentation contribution. 

- Fork the `master repository <https://github.com/abess-team/abess>`__ by clicking on the “Fork” button on the top right of the page, which would create a copy to your own GitHub account;

-  Clone your fork of abess to the local by
   `Git <https://git-scm.com/>`__;

   .. code:: bash

      $ git clone https://github.com/your_account_name/abess.git
      $ cd abess

-  Create a new branch, e.g. named ``my_branch``, to hold your
   development changes:

   .. code:: bash

      $ git branch my_branch
      $ git checkout my_branch

   It is preferred to work on your own branch instead of the master one;

-  Commit your improvements or additions to documentation (forming an
   ideally legible commit history):

   .. code:: bash

      $ git add changed_files
      $ git commit -m "some commits"
      $ git push

-  Merge your branch with the master branch that have the up-to-date
   codes in `abess <https://github.com/abess-team/abess>`__;

-  Submit a pull request explaining your contribution for documentation.

The `online documentation <https://abess.readthedocs.io>`__ for our
project are generated by generation by
`Sphinx <https://www.sphinx-doc.org/en/master/index.html>`__ and 
`sphinix-gallery <https://pypi.org/project/sphinx-gallery/>`__ for python and
`pkgdown <https://pkgdown.r-lib.org/index.html>`__ for R. 
Our website is published via `readthedocs <https://readthedocs.org>`__.

Python document
~~~~~~~~~~~~~~~

The Python document includes two parts. The first part depicts the APIs in `abess`, and the second part aims to show simple use-cases and on-board new users.

Python API
^^^^^^^^^^

For the development of Python documentation, there is a little
difference between a new method and a new function. A new method need a
brief introduction and some examples, such as
`[link] <https://github.com/abess-team/abess/blob/master/python/abess/linear.py#:~:text=class%20abessLogistic(bess_base)%3A-,%22%22%22,%22%22%22,-def%20__init__(self)>`__;
and a new function under should at least contain an introduction and the
parameters it requires, such as
`[link] <https://github.com/abess-team/abess/blob/master/python/abess/linear.py#:~:text=return%20y-,def%20score(self%2C%20X%2C%20y)%3A,%22%22%22,-X%2C%20y%20%3D%20self>`__.
Also note that the style of Python document is similar to
`numpydoc <https://numpydoc.readthedocs.io/en/latest/format.html>`__.

The development of Python API’s documentation relies on
`Sphinx <https://pypi.org/project/Sphinx/>`__,
`nbsphinx <https://pypi.org/project/nbsphinx/>`__ (support jupyter
notebook for Sphinx),
`myst-parser <https://pypi.org/project/myst-parser/>`__ (support
markdown for Sphinx),
`sphinx-rtd-theme <https://pypi.org/project/sphinx-rtd-theme/>`__
(support “Read the Docs” theme for Sphinx). Make sure these packages
have been installed.

Tutorials
^^^^^^^^^

A tutorial is a long-form guide to some essential functions in the
``abess`` package. We recommend to use a tutorial to:

-  describes the problem that one function can solve;

-  show the reader how to solve with the function;

-  give more details about the potential advanced usage.

A typical online vignette example is present
`[here] <https://abess.readthedocs.io/en/latest/auto_gallery/1-glm/plot_1_LinearRegression.html>`__.

The development of the tutorial relies on `sphinix-gallery <https://pypi.org/project/sphinx-gallery/>`__.

The development of Python document
^^^^^^^^^

There are three basic steps to write documentation for the Python document:

1. Add comments to Python files

You can refer to ``General procedure``, or do the following brief steps:

- Fork the  `master repository <https://github.com/abess-team/abess>`__ as the same of the first steps of ``General procedure``;

- Access in ``your_account_name/abess``, then click on the “master” button and create a  new branch, e.g. named ``my_branch``. Upload files in the suitable directory.

If you use packages that aren't base packages in your comments, please add them in ``docs/requirements.txt`` to make the cloud server running with the packages correctly.

2. Preview documentation

In this step, packages `virtualenv <https://pypi.org/project/virtualenv>`__ is required to create isolated Python environments. Make sure the package have been installed.

- Choose a local directory you prefer then create isolated Python environments. Run the   
  following code in command line:
  
  .. code:: bash

      $ cd directory_you_prefer
      $ virtualenv env_name
     
  "env_name" is the name of the virtual environment directory, and 
  you can customize the name;

- Activate the virtual environment, and "cd" to ``env_name\Scripts`` directory:
  
  - Under windows:
  
    .. code:: bash

        $ cd env_name\Scripts
        $ .\activate
        
    If you get error when running ``.\activate``, Run the following code then enter "y" before running ``.\activate``:
    
    .. code:: bash

        $ set-executionpolicy remotesigned
        
  - Under Mac:
   
    .. code:: bash

         $ source env_name/bin/activate
         $ cd env_name\Scripts

- Clone your fork of abess to ``env_name\Scripts`` directory. If you have already clone it, just copy it here.
  
  Run the following code in in command line or git:
  
  .. code:: bash

      $ git clone https://github.com/your_account_name/abess.git
     
  Or run the following code to clone the new branch:
  
  .. code:: bash

      $ git clone -b my_branch https://github.com/your_account_name/abess.git
   
  You can also clone it from the `github desktop <https://desktop.github.com/>`__ ;
   
- "cd" to ``abess\docs`` directory, then convert comments to ``.html`` files:
  
  .. code:: bash

      $ cd abess\docs
      $ .\make html

- Preview documentation by open/refresh the ``.html`` files in ``docs/_build/html`` directory.

3. Submit a pull request

Repeat steps 1-2 until you are satisfied with the documentation. Then submit a pull request from ``my_branch`` to ``abess-team/abess``.

More advanced topics for writing documentation are available at: `Sphinx <https://www.sphinx-doc.org/en/master/>`__.

R document
~~~~~~~~~~

The R document includes two parts. The first part depicts the APIs in the `abess` R package, and the second part aims to show simple use-cases and on-board new users.

R function
^^^^^^^^^^

For the development of R documentation, the most important thing to know
is that the abess R package relies on
`roxygen2 <https://cran.r-project.org/web/packages/roxygen2>`__ package.
This means that documentation is found in the R code close to the source
of each function. Before writing the documentation, it would be better
to ensure the usage of the `Rd
tags <https://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html>`__.

There are four basic steps to write documentation for the R function in
abess:

1. Add comments to ``R`` files in ``R-package/R`` directory.

2. Run ``devtools::document()`` in R to convert roxygen comments to
   ``.Rd`` files.

3. Preview documentation with ``?``.

4. Repeat steps 1-3 until you are satisfied with the documentation.

More advanced topics for writing object documentation are available at:
https://r-pkgs.org/man.html.

Online vignette
^^^^^^^^^^^^^^^

The aim of a online R vignette is the same as a tutorial for Python
package. A typical online vignette example is presented in this
`[link] <https://abess-team.github.io/abess/articles/v03-classification.html>`__.
We strongly recommend to use R markdown (``.Rmd`` files) to organize a
online vignette.

There are also four steps to write online vignettes:

1. Add/modify to ``.Rmd`` files in ``R-package/vignettes`` directory.

2. Run ``pkgdown::build_articles()`` in R to convert ``.Rmd`` files to
   webpages. (Make sure the ``pkgdown`` R package has been installed.)

3. Preview the webpages.

4. Repeat steps 1-3 until you are satisfied with the vignettes.

You can learn many detail about ``pkgdown`` package and R markdown in
`pkgdown’s
website <https://pkgdown.r-lib.org/reference/build_home.html>`__ and
`Hadley’s website <https://r-pkgs.org/vignettes.html>`__, respectively.

