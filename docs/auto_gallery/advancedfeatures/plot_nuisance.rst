
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery\advancedfeatures\plot_nuisance.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_gallery_advancedfeatures_plot_nuisance.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_advancedfeatures_plot_nuisance.py:


Nuisance Regression
========================
Nuisance regression refers to best subset selection with some prior information that some variables are required to stay in the active set. For example, if we are interested in a certain gene and want to find out what other genes are associated with the response when this particular gene shows effect.

In the `LinearRegression()` (or other methods), the argument `always_select` is designed to realize this goal. User can pass a vector containing the indexes of the target variables to `always_select`. Here is an example.

.. GENERATED FROM PYTHON SOURCE LINES 8-29

.. code-block:: default


    import numpy as np
    from abess.datasets import make_glm_data
    from abess.linear import LinearRegression

    np.random.seed(0)

    # gene data
    n = 100
    p = 20
    k = 5
    dt = make_glm_data(n = n, p = p, k = k, family = 'gaussian')
    print('real coefficients:\n', dt.coef_, '\n')
    print('real coefficients\' indexes:\n', np.nonzero(dt.coef_)[0])


    model = LinearRegression(support_size = range(0, 6))
    model.fit(dt.x, dt.y)
    print('fitted coefficients:\n', model.coef_, '\n')
    print('fitted coefficients\' indexes:\n', np.nonzero(model.coef_)[0])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    real coefficients:
     [  0.           0.         115.01218243   0.           0.
      81.84924757   0.           0.           0.           0.
     104.77568224  64.30426355   0.           0.           0.
       0.           0.           0.         108.5408557    0.        ] 

    real coefficients' indexes:
     [ 2  5 10 11 18]
    fitted coefficients:
     [  0.           0.         114.93792167   0.           0.
      81.8124385    0.           0.           0.           0.
     104.67076232  64.40856101   0.           0.           0.
       0.           0.           0.         108.73726174   0.        ] 

    fitted coefficients' indexes:
     [ 2  5 10 11 18]




.. GENERATED FROM PYTHON SOURCE LINES 30-32

The coefficients are located in \[2, 5, 10, 11, 18\]. 
But if we suppose that the 7th and 8th variables are worthy to be included in the model, we can call:

.. GENERATED FROM PYTHON SOURCE LINES 32-39

.. code-block:: default



    model = LinearRegression(support_size = range(0, 6), always_select = [7, 8])
    model.fit(dt.x, dt.y)
    print('fitted coefficients:\n', model.coef_, '\n')
    print('fitted coefficients\' indexes:\n', np.nonzero(model.coef_)[0])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    fitted coefficients:
     [  0.           0.         117.18370615   0.           0.
       0.           0.           5.09643891  -1.00521149   0.
      91.65760504   0.           0.           0.           0.
       0.           0.           0.         121.21120638   0.        ] 

    fitted coefficients' indexes:
     [ 2  7  8 10 18]




.. GENERATED FROM PYTHON SOURCE LINES 40-45

Now the variables we chosen are always in the model.

R tutorial
-----------------------
For R tutorial, please view [https://abess-team.github.io/abess/articles/v07-advancedFeatures.html](https://abess-team.github.io/abess/articles/v07-advancedFeatures.html).


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.005 seconds)


.. _sphx_glr_download_auto_gallery_advancedfeatures_plot_nuisance.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_nuisance.py <plot_nuisance.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_nuisance.ipynb <plot_nuisance.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
