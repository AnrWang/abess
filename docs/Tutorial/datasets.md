# Datasets Generator

**abess** includes build-in random sample generators from different distributions in `abess.datasets` module, which can be used for simulation and testing.

- single-label data: for [gaussian](#gaussian), [binomial](#binomial), [poisson](#poisson), [gamma](#gamma) or [coxPH](#coxph) model;
- multi-label data: for [multitask](#multitask) or [multinomial](#multinomial) model.

The input can be checked in the [API document](https://abess.readthedocs.io/en/latest/Python-package/datasets/index.html).
The output, whose type is named `data`, contains three elements: `x`, `y` and `coef_`, which correspond the variables, responses and coefficients, respectively. Each row of `x` or `y` indicates a sample.

## Single-label Data

The single-label data can be generated by `make_glm_data`. Its argument `family` determines what distribution to fit.

### Gaussian

Usage: `family='gaussian'[, sigma=...]`

Model: $y \sim N(\mu, \sigma^2),\ \mu = x^T\beta$.
- the coefficient $\beta\sim U[m, 100m]$, where $m = 5\sqrt{2\log p/n}$;
- the variance $\sigma = 1$.

### Binomial

Usage: `family='binomial'`

Model: $y \sim \text{Binom}(\pi),\ \text{logit}(\pi) = x^T \beta$.
- the coefficient $\beta\sim U[2m, 10m]$, where $m = 5\sqrt{2\log p/n}$.

### Poisson

Usage: `family='poisson'`

Model: $y \sim \text{Poisson}(\lambda),\ \lambda = \exp(x^T \beta)$.
- the coefficient $\beta\sim U[2m, 10m]$, where $m = 5\sqrt{2\log p/n}$.

### Gamma

Usage: `family='gamma'`

Model: $y \sim \text{Gamma}(k, \theta),\ k\theta = \exp(x^T \beta + \epsilon), k\sim U[0.1, 100.1]$ in shape-scale definition.
- the coefficient $\beta\sim U[m, 100m]$, where $m = 5\sqrt{2\log p/n}$.

### CoxPH

Usage: `family='cox'[, scal=..., cencering=..., c=...]`

Model: $y=\min(t,C)$, where $t = \left[-\dfrac{\log U}{\exp(X \beta)}\right]^s,\ U\sim N(0,1),\ s=\dfrac{1}{\text{scal}}$ and censoring time $C\sim U(0, c)$.
- the coefficient $\beta\sim U[2m, 10m]$, where $m = 5\sqrt{2\log p/n}$;
- the scale of survival time $\text{scal} = 10$;
- censoring is enabled, and max censoring time $c=1$.

## Multi-label Data

The multi-label data can be generated by `make_multivariate_glm_data`. Its argument `family` determines what distribution to fit.

### Multitask

Usage: `family='multigaussian'`

Model: $Y \sim N(\mu, \Sigma),\ \mu=x^T \beta$.
- the variance $\Sigma = \text{diag}(1, 1, \cdots, 1)$;
- the coefficients $\beta$ contains 30\% "strong" values, 40\% "moderate" values and the rest are "weak". They come from $N(0, 10)$, $N(0, 5)$ and $N(0, 2)$, respectively.

### Multinomial

Usage: `family='multinomial'`

Model: $Y$ is a 0-1 array with only one 1 for a sample. Its index is chosed under probabilities $\pi = \exp(x^T \beta)$.
- the coefficients $\beta$ contains 30\% "strong" values, 40\% "moderate" values and the rest are "weak". They come from $N(0, 10)$, $N(0, 5)$ and $N(0, 2)$, respectively.
